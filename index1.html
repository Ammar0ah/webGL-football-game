<html>

<head>
	<title>WebGL Project</title>
	<style>
		body {
			margin: 0;
		}

		canvas {
			width: 100%;
			height: 100%
		}
	</style>
</head>

<body>
	<script src="node_modules/three/examples/js/controls"></script>
	<script src="node_modules/three/examples/js/objects/Sky.js"></script>
	<script src="node_modules/three/examples/js/libs/dat.gui.min.js"></script>
	<script src="node_modules/three/build/three.js"></script>  
	<script src="node_modules/three/examples/js/loaders/OBJLoader.js"></script>
	<script src="node_modules/three/examples/js/controls/OrbitControls.js"></script>
	<script src="node_modules/three/examples/js/loaders/GLTFLoader.js"></script>

	<script>
		var scene = new THREE.Scene();

		var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 4000);
		camera.position.z = 500;
		camera.position.y = 200;

		var renderer = new THREE.WebGLRenderer();
		renderer.setSize(window.innerWidth, window.innerHeight);
		document.body.appendChild(renderer.domElement);
		scene.background = new THREE.Color(0xcce0ff);
		scene.add(new THREE.AmbientLight(0x666666, 0.5));
		var light;
		initLight();
		initPitch();

		initSky();

		initBall();
		initSkyBox();


		function initSkyBox() {
			var skyBox = new THREE.BoxGeometry(4000,1000,3000);
		
		var materials = 
		[
			new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load('img/footballwall.jpg') ,side :THREE.DoubleSide}),
			new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load('img/footballwall.jpg') ,side :THREE.DoubleSide}),
			new THREE.MeshBasicMaterial( { transparent: true, opacity: 0, wireframe: true, side: THREE.DoubleSide} ),
			new THREE.MeshBasicMaterial( { transparent: true, opacity: 0, wireframe: true, side: THREE.DoubleSide} ),
			new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load('img/footballwall.jpg') ,side :THREE.DoubleSide}),
			new THREE.MeshBasicMaterial( { transparent: true, opacity: 0, wireframe: true, side: THREE.DoubleSide} ),
		]
		var faceMaterial = new THREE.MeshFaceMaterial(materials);
		var skyBoxMesh = new THREE.Mesh(skyBox , faceMaterial);
		skyBoxMesh.position.y = 400;
		scene.add(skyBoxMesh);
		}
	
		function initSky() {
			// Add Sky
			sky = new THREE.Sky();
			sky.scale.setScalar(450000);
			sky.position.z = -100;
			scene.add(sky);
			// Add Sun Helper
			sunSphere = new THREE.Mesh(
				new THREE.SphereBufferGeometry(20000, 16, 8),
				new THREE.MeshBasicMaterial({ color: 0xffffff })
			);
			sunSphere.position.y = - 700000;
			sunSphere.visible = true;
			scene.add(sunSphere);
			/// GUI
			var effectController = {
				turbidity: 10,
				rayleigh: 2,
				mieCoefficient: 0.005,
				mieDirectionalG: 0.8,
				luminance: 1,
				inclination: 0.49, // elevation / inclination
				azimuth: 0.25, // Facing front,
				sun: ! true
			};
			var distance = 400000;
			function guiChanged() {
				var uniforms = sky.material.uniforms;
				uniforms.turbidity.value = effectController.turbidity;
				uniforms.rayleigh.value = effectController.rayleigh;
				uniforms.luminance.value = effectController.luminance;
				uniforms.mieCoefficient.value = effectController.mieCoefficient;
				uniforms.mieDirectionalG.value = effectController.mieDirectionalG;
				var theta = Math.PI * (effectController.inclination - 0.5);
				var phi = 2 * Math.PI * (effectController.azimuth - 0.5);
				sunSphere.position.x = distance * Math.cos(phi);
				sunSphere.position.y = distance * Math.sin(phi) * Math.sin(theta);
				sunSphere.position.z = distance * Math.sin(phi) * Math.cos(theta);
				sunSphere.rotation.y += 50;
				sunSphere.visible = effectController.sun;
				uniforms.sunPosition.value.copy(sunSphere.position);


				renderer.render(scene, camera);


			}
			var gui = new dat.GUI();
			gui.add(effectController, "turbidity", 1.0, 20.0, 0.1).onChange(guiChanged);
			gui.add(effectController, "rayleigh", 0.0, 4, 0.001).onChange(guiChanged);
			gui.add(effectController, "mieCoefficient", 0.0, 0.1, 0.001).onChange(guiChanged);
			gui.add(effectController, "mieDirectionalG", 0.0, 1, 0.001).onChange(guiChanged);
			gui.add(effectController, "luminance", 0.0, 2).onChange(guiChanged);
			gui.add(effectController, "inclination", 0, 1, 0.0001).onChange(guiChanged);
			gui.add(effectController, "azimuth", 0, 1, 0.0001).onChange(guiChanged);
			gui.add(effectController, "sun").onChange(guiChanged);
			guiChanged();
		}
			
		//controls  
		var animate = function () {
			requestAnimationFrame(animate);
			

			
			renderer.render(scene, camera);
		};

		controls = new THREE.OrbitControls(camera, renderer.domElement);

		controls.addEventListener('change', function () { renderer.render(scene, camera); });
		controls.update();
		camera.lookAt(sunSphere.position);


		animate();

		function initLight() {
			 light = new THREE.DirectionalLight(0xdfebff, 1);
			light.position.set(50, 200, 100);
			light.position.multiplyScalar(1.3);
			light.castShadow = true;
			light.shadow.mapSize.width = 1024;
			light.shadow.mapSize.height = 1024;
			var d = 300;
			light.shadow.camera.left = - d;
			light.shadow.camera.right = d;
			light.shadow.camera.top = d;
			light.shadow.camera.bottom = - d;
			light.shadow.camera.far = 4000;
			scene.add(light);
		}
		function initPitch() {
			var geometry = new THREE.PlaneGeometry(15,10, 5, 5);
			var groundTexture = new THREE.TextureLoader().load('img/grasslight-big.jpg');
			groundTexture.wrapS = groundTexture.wrapT = THREE.RepeatWrapping;
			groundTexture.repeat.set(25, 25);
			groundTexture.anisotropy = 16;

			var groundMaterial = new THREE.MeshLambertMaterial({ map: groundTexture });

				var mesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(4000, 3000), groundMaterial);
			mesh.position.y = - 50;
			mesh.rotation.x = - Math.PI / 2;
			mesh.receiveShadow = true;
			scene.add(mesh);
		}

		function initBall() {
			var sphere = new THREE.SphereGeometry(35, 20, 20);
			var ballTexture = new THREE.TextureLoader().load('img/ballTexture.jpg');
			var material1 = new THREE.MeshLambertMaterial({ map: ballTexture });
			var mesh1 = new THREE.Mesh(sphere, material1);
			mesh1.receiveShadow = true;
			mesh1.castShadow = true;
			mesh1.position.y += 50;
			mesh1.position.z += 200;
			var pointLight = new THREE.PointLight(0xffffff, 1);
			pointLight.position.set(25, 50, 25);
			scene.add(pointLight);

			renderer.shadowMap.enabled = true;
			scene.add(mesh1);
		}
	</script>



</body>

</html>